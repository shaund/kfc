Monocle={VERSION:"1.0.0"};Monocle.addListener=function(c,d,b,a){if(c.addEventListener){return c.addEventListener(d,b,a||false)}else{if(c.attachEvent){return c.attachEvent("on"+d,b)}}};Monocle.removeListener=function(c,f,b,a){if(c.removeEventListener){return c.removeEventListener(f,b,a||false)}else{if(c.detachEvent){try{return c.detachEvent("on"+f,b)}catch(d){}}}};if(typeof(MONOCLE_NO_COMPAT)=="undefined"){if(typeof window.console=="undefined"){window.console={messages:[],log:function(a){this.messages.push(a)}}}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(b){var a=this.length>>>0;var c=Number(arguments[1])||0;c=(c<0)?Math.ceil(c):Math.floor(c);if(c<0){c+=a}for(;c<a;c++){if(c in this&&this[c]===b){return c}}return -1}}}Monocle.Reader=function(w,f,h){if(Monocle==this){return new Monocle.Reader(w,f,h)}var y={durations:{RESIZE_DELAY:200},abortMessage:{CLASSNAME:"monocleAbortMessage",TEXT:"Your browser does not support this technology."},FLIPPER_DEFAULT_CLASS:(typeof(Monocle.Flippers.Slider)=="undefined")?null:Monocle.Flippers.Slider,FLIPPER_LEGACY_CLASS:(typeof(Monocle.Flippers.Legacy)=="undefined")?null:Monocle.Flippers.Legacy,TOUCH_DEVICE:(typeof Touch=="object")};var t={divs:{box:null,container:null,overlay:null,pages:[]},controls:[],pageWidth:0,book:null,interactionData:{},resizeTimer:null};var v={constructor:Monocle.Reader,properties:t,constants:y};function c(G,H,p){t.divs.box=typeof(G)=="string"?document.getElementById(G):G;p=p||{};a("monocle:initializing");var k;if(H){k=new Monocle.Book(H)}else{k=Monocle.Book.fromHTML(t.divs.box.innerHTML)}t.divs.box.innerHTML="";u();s(p.flipper);d();a("monocle:loading");i();A(k);E();a("monocle:loaded")}function u(){var p;if(document.defaultView){var k=document.defaultView.getComputedStyle(t.divs.box,null);p=k.getPropertyValue("position")}else{if(t.divs.box.currentStyle){p=t.divs.box.currentStyle.position}}if(["absolute","relative"].indexOf(p)==-1){t.divs.box.style.position="relative"}}function d(){t.divs.container=document.createElement("div");t.divs.box.appendChild(t.divs.container);for(var k=0;k<t.flipper.pageCount;++k){var p=t.divs.pages[k]=document.createElement("div");p.pageIndex=k;t.flipper.addPage(p);t.divs.container.appendChild(p);p.scrollerDiv=document.createElement("div");p.appendChild(p.scrollerDiv);p.contentDiv=document.createElement("div");p.scrollerDiv.appendChild(p.contentDiv)}t.divs.overlay=document.createElement("div");t.divs.box.appendChild(t.divs.overlay)}function s(p){if(navigator.product!="Gecko"){if(!y.FLIPPER_LEGACY_CLASS){var k=document.createElement("div");k.className=y.abortMessage.CLASSNAME;k.innerHTML=y.abortMessage.TEXT;t.divs.box.appendChild(k);return}p=y.FLIPPER_LEGACY_CLASS}else{if(!p){p=y.FLIPPER_DEFAULT_CLASS;if(!p){throw ("No flipper class")}}}t.flipper=new p(v,q)}function i(){t.divs.container.style.cssText=Monocle.Styles.ruleText("container");for(var k=0;k<t.flipper.pageCount;++k){var p=t.divs.pages[k];p.style.cssText=Monocle.Styles.ruleText("page");p.scrollerDiv.style.cssText=Monocle.Styles.ruleText("scroller");p.contentDiv.style.cssText=Monocle.Styles.ruleText("content")}t.divs.overlay.style.cssText=Monocle.Styles.ruleText("overlay")}function o(){i();z()}function A(k){if(!a("monocle:bookchanging",{},true)){return}t.book=k;z();a("monocle:bookchange");return t.book}function b(){return t.book}function B(){if(!a("monocle:resizing",{},true)){return}clearTimeout(t.resizeTimer);t.resizeTimer=setTimeout(function(){z();a("monocle:resize")},y.durations.RESIZE_DELAY)}function z(){t.boxDimensions={left:0,top:0,width:t.divs.box.offsetWidth,height:t.divs.box.offsetHeight};var H=t.divs.box;do{t.boxDimensions.left+=H.offsetLeft;t.boxDimensions.top+=H.offsetTop}while(H=H.offsetParent);if(typeof(t.flipper.overrideDimensions)!="function"){var I=t.flipper.visiblePages()[0];t.pageWidth=I.offsetWidth;var k=I.scrollerDiv.offsetWidth;for(var p=0;p<t.divs.pages.length;++p){var G=t.divs.pages[p].contentDiv;G.style.webkitColumnWidth=G.style.MozColumnWidth=k+"px"}}else{t.flipper.overrideDimensions()}r({page:D()})}function D(p){var k=t.flipper.getPlace(p);return k?(k.pageNumber()||1):1}function C(k){return t.flipper.getPlace(k)}function r(k){t.flipper.moveTo(k)}function g(G){var p=t.flipper.visiblePages()[0];var k=t.book.placeOfChapter(p.contentDiv,G);r(k.getLocus())}function q(p,G,I){var H={page:p,locus:G};if(!a("monocle:pagechanging",H,true)){return}var k=t.book.changePage(p.contentDiv,G);if(!k){return false}if(typeof I=="function"){I(k.offset)}H.pageNumber=k.page;H.componentId=k.componentId;a("monocle:pagechange",H);return k.page}function E(){if(!y.TOUCH_DEVICE){Monocle.addListener(t.divs.container,"mousedown",function(k){if(k.button!=0){return}t.interactionData.mouseDown=true;l(k,"start",k)});Monocle.addListener(t.divs.container,"mousemove",function(k){if(!t.interactionData.mouseDown){return false}l(k,"move",k)});Monocle.addListener(t.divs.container,"mouseup",function(k){if(!t.interactionData.mouseDown){return false}l(k,"end",k)});Monocle.addListener(t.divs.container,"mouseout",function(k){if(!t.interactionData.mouseDown){return false}obj=k.relatedTarget||e.fromElement;while(obj&&(obj=obj.parentNode)){if(obj==t.divs.container){return}}l(k,"end",k)})}else{Monocle.addListener(t.divs.container,"touchstart",function(k){if(k.touches.length>1){return}l(k,"start",k.targetTouches[0]);k.preventDefault()});Monocle.addListener(t.divs.container,"touchmove",function(k){if(k.touches.length>1){return}var p={x:k.targetTouches[0].pageX-t.boxDimensions.left,y:k.targetTouches[0].pageY-t.boxDimensions.top,w:t.boxDimensions.width,h:t.boxDimensions.height};if(p.x<0||p.y<0||p.x>=p.w||p.y>=p.h){l(k,"end",k.targetTouches[0])}else{l(k,"move",k.targetTouches[0])}k.preventDefault()});Monocle.addListener(t.divs.container,"touchend",function(k){l(k,"end",k.changedTouches[0]);k.preventDefault()});Monocle.addListener(t.divs.container,"touchcancel",function(k){l(k,"end",k.changedTouches[0])});Monocle.addListener(window,"orientationchange",B,true)}t.flipper.listenForInteraction()}function l(k,p,G){cData={contactX:Math.min(t.boxDimensions.width,Math.max(0,G.pageX-t.boxDimensions.left)),contactY:Math.min(t.boxDimensions.height,Math.max(0,G.pageY-t.boxDimensions.top))};if(!a("monocle:contact:"+p,cData,true)||!a("monocle:contact:"+p+":unhandled",cData,true)){k.preventDefault()}if(p=="end"){t.interactionData={}}}function x(L,k,p){for(var H=0;H<t.controls.length;++H){if(t.controls[H].control==L){console.log("Already added control: "+L);return}}p=p||{};var I={control:L,elements:[],controlType:k};t.controls.push(I);var G;if(!k||k=="standard"){G=L.createControlElements(t.divs.container);t.divs.container.appendChild(G);I.elements.push(G)}else{if(k=="page"){for(var H=0;H<t.divs.pages.length;++H){var K=t.divs.pages[H];var J=L.createControlElements(K);K.appendChild(J);I.elements.push(J)}}else{if(k=="modal"||k=="popover"){G=L.createControlElements(t.divs.overlay);t.divs.overlay.appendChild(G);I.elements.push(G);I.usesOverlay=true}else{if(k=="invisible"){if(typeof(L.createControlElements)=="function"&&(G=L.createControlElements(t.divs.container))){t.divs.container.appendChild(G);I.elements.push(G)}}else{console.log("Unknown control type: "+k)}}}}for(var H=0;H<I.elements.length;++H){I.elements[H].style.cssText+=Monocle.Styles.ruleText("control")}if(p.hidden){n(L)}else{j(L)}return L}function F(p){for(var k=0;k<t.controls.length;++k){if(t.controls[k].control==p){return t.controls[k]}}}function n(G){var k=F(G);if(!k){throw ("No data for control: "+G)}if(k.hidden){return}for(var p=0;p<k.elements.length;++p){k.elements[p].style.display="none"}if(k.usesOverlay){t.divs.overlay.style.display="none";var H=y.TOUCH_DEVICE?"touchstart":"mousedown";Monocle.removeListener(t.divs.overlay,H,t.divs.overlay.clickFn)}k.hidden=true;if(G.properties){G.properties.hidden=true}}function j(G){var k=F(G);if(!k){throw ("No data for control: "+G)}if(k.hidden==false){return}for(var p=0;p<k.elements.length;++p){k.elements[p].style.display="block"}if(k.usesOverlay){t.divs.overlay.style.display="block"}if(k.controlType=="popover"){t.divs.overlay.clickFn=function(I){obj=I.target||window.event.srcElement;do{if(obj==k.elements[0]){return true}}while(obj&&(obj=obj.parentNode));n(G)};var H=y.TOUCH_DEVICE?"touchstart":"mousedown";Monocle.addListener(t.divs.overlay,H,t.divs.overlay.clickFn)}k.hidden=false;if(G.properties){G.properties.hidden=false}}function a(H,G,p){if(!document.createEvent){return true}var k=document.createEvent("Events");k.initEvent(H,false,p||false);k.monocleData=G;return t.divs.box.dispatchEvent(k)}function m(G,p,k){Monocle.addListener(t.divs.box,G,p,k)}v.setBook=A;v.getBook=b;v.reapplyStyles=o;v.getPlace=C;v.moveTo=r;v.skipToChapter=g;v.resized=B;v.addControl=x;v.hideControl=n;v.showControl=j;v.dispatchEvent=a;v.addListener=m;c(w,f,h);return v};Monocle.Book=function(a){if(Monocle==this){return new Monocle.Book(a)}var g={};var c={dataSource:a,components:[],places:[],chapters:{}};var d={constructor:Monocle.Book,constants:g,properties:c};function h(){c.componentIds=a.getComponents();c.contents=a.getContents();c.lastCIndex=c.componentIds.length-1}function m(k,q){var o=l(k)||f(k,j(0),1);var u=c.componentIds.indexOf(q.componentId);var t;if(u==-1){t=o.properties.component}else{t=j(u)}if(t!=o.properties.component){t.applyTo(k)}var r=t.lastPageNumber();var p=t.updateDimensions(k);var v=1;if(typeof(q.page)=="number"){v=q.page}else{if(typeof(q.percent)=="number"){o=f(k,t,1);v=o.pageAtPercentageThrough(q.percent)}else{if(typeof(q.direction)=="number"){v=o.pageNumber();v+=q.direction}else{if(typeof(q.anchor)=="string"){if(q.position=="start"){v=1}else{if(q.position=="end"){v=t.lastPageNumber()}}}else{console.log("Unrecognised locus: "+q)}}}}if(p&&parseInt(r)){v=Math.max(Math.round(t.lastPageNumber()*(v/r)),1)}u=t.properties.index;var s=t.lastPageNumber();if(u==0&&v<1){return false}else{if(u==c.lastCIndex&&v>t.lastPageNumber()){return false}else{if(v>t.lastPageNumber()){v-=t.lastPageNumber();t=j(u+1);return m(k,{page:v,componentId:t.properties.id})}else{if(v<1){t=j(u-1);t.updateDimensions(k);v+=t.lastPageNumber();return m(k,{page:v,componentId:t.properties.id})}}}}t.prepareNode(k,v);f(k,t,v);return{componentId:t.properties.id,page:v,offset:(v-1)*k.parentNode.offsetWidth}}function l(o){for(var k=c.places.length-1;k>=0;--k){if(c.places[k][0]==o){return c.places[k][1]}}return null}function f(q,o,p){var k=l(q);if(!k){k=new Monocle.Place();c.places[c.places.length]=[q,k]}k.setPlace(o,p);return k}function j(k){if(!c.components[k]){var p=c.componentIds[k];var o=c.dataSource.getComponent(p);c.components[k]=new Monocle.Component(d,p,k,n(p),o)}return c.components[k]}function n(r){if(c.chapters[r]){return c.chapters[r]}c.chapters[r]=[];var q=new RegExp("^"+r+"(#(.+)|$)");var p;var k=function(t){if(p=t.src.match(q)){c.chapters[r].push({title:t.title,fragment:p[2]||null})}if(t.children){for(var s=0;s<t.children.length;++s){k(t.children[s])}}};for(var o=0;o<c.contents.length;++o){k(c.contents[o])}return c.chapters[r]}function i(p,k){var s=new RegExp("^(.+?)(#(.*))?$");var r=k.match(s);if(r){var o=r[1];var t=r[3]||null;var v=c.componentIds.indexOf(o);var u=j(v);u.updateDimensions(p);var q=new Monocle.Place(p);if(t){q.setPlace(u,u.pageForChapter(t))}else{q.setPlace(u,1)}return q}return null}function b(){return c.contents}d.getMetaData=a.getMetaData;d.changePage=m;d.chapterTree=b;d.chaptersForComponent=n;d.placeFor=l;d.placeOfChapter=i;h();return d};Monocle.Book.fromHTML=function(a){var b={getComponents:function(){return["anonymous"]},getContents:function(){return[]},getComponent:function(c){return a},getMetaData:function(c){}};return new Monocle.Book(b)};Monocle.Place=function(){if(Monocle==this){return new Monocle.Place()}var h={};var b={component:null,percent:null};var c={constructor:Monocle.Place,constants:h,properties:b};function n(k,o){b.component=k;b.percent=o/k.lastPageNumber();b.chapter=null}function l(k,o){b.component=k;b.percent=o;b.chapter=null}function j(){return b.component.properties.id}function d(){return b.percent}function i(k){return Math.round(b.component.lastPageNumber()*k)}function m(){return i(b.percent)}function g(){if(b.chapter){return b.chapter}return b.chapter=b.component.chapterForPage(m())}function f(){var k=g();return k?k.title:null}function a(k){k=k||{};var o={page:m(),componentId:j()};if(k.direction){o.page+=k.direction}return o}c.setPlace=n;c.setPercentageThrough=l;c.componentId=j;c.percentageThrough=d;c.pageAtPercentageThrough=i;c.pageNumber=m;c.chapterInfo=g;c.chapterTitle=f;c.getLocus=a;return c};Monocle.Place.FromPageNumber=function(c,b){var a=new Monocle.Place();a.setPlace(c,b);return a};Monocle.Place.FromPercentageThrough=function(b,c){var a=new Monocle.Place();a.setPercentageThrough(b,c);return a};Monocle.Component=function(n,s,h,f,j){if(Monocle==this){return new Monocle.Component(n,s,h,f,j)}var y={};var r={book:n,id:s,index:h,chapters:f,html:j,clientNodes:[],elementsForClient:[],chunks:[],clientDimensions:[]};var u={constructor:Monocle.Component,constants:y,properties:r};function a(){if(!r.html){console.log("Accessed an empty component: "+r.id);r.html="<p></p>"}var p=r.elementsForClient[0]=[];var k=document.createElement("div");k.innerHTML=r.html;while(k.hasChildNodes()){var F=k.removeChild(k.firstChild);if(F.nodeType==1){p.push(F)}else{if(F.nodeType==3&&!F.nodeValue.match(/^\s+$/)){var E=document.createElement("div");E.appendChild(F);p.push(E)}}}delete (k)}function z(k){return r.clientNodes.indexOf(k)}function b(E,p){for(var k=0;k<r.chunks.length;++k){if(r.chunks[k].firstPageNumber-1<=p){w(E,r.chunks[k])}else{C(E,r.chunks[k])}}}function g(p){var E=null;for(var k=0;k<r.chapters.length;++k){if(p>=r.chapters[k].page){E=r.chapters[k]}else{return E}}return E}function d(k){if(!k){return 1}for(var p=0;p<r.chapters.length;++p){if(r.chapters[p].fragment==k){return r.chapters[p].page}}return null}function w(p,k){var E=r.elementsForClient[z(p)].slice(k.firstElementIndex,k.lastElementIndex);if(E[0].parentNode==p){return}c(p,E)}function C(p,k){var E=r.elementsForClient[z(p)].slice(k.firstElementIndex,k.lastElementIndex);if(E[0].parentNode!=p){return}x(p,E)}function A(k){q(k);x(k)}function i(p){q(p);if(o(p)){x(p);c(p,r.elementsForClient[z(p)]);D(p);B(p);l(p);for(var k=0;k<r.clientNodes.length;++k){x(r.clientNodes[k])}return true}else{return false}}function q(F){if(z(F)!=-1){return}r.clientNodes.push(F);if(!r.elementsForClient[z(F)]){var G=r.elementsForClient[0];var p=r.elementsForClient[z(F)]=[];var k=G.length;for(var E=0;E<k;++E){p[E]=G[E].cloneNode(true)}}}function o(k){return(!r.clientDimensions)||(r.clientDimensions.width!=k.parentNode.offsetWidth)||(r.clientDimensions.height!=k.parentNode.offsetHeight)||(r.clientDimensions.fontSize!=k.style.fontSize)}function m(F){if(!F.getBoundingClientRect){console.log("Image positioning not supported");return}else{console.log("Positioning images to top of pages")}var k=F.getBoundingClientRect();var G=F.getElementsByTagName("img");for(var p=0;p<G.length;++p){var E=G[p].getBoundingClientRect();if(E.top==k.top){G[p].style.marginTop=0}else{G[p].style.marginTop=(k.height-(E.top-k.top))+"px"}}}function D(k){r.clientDimensions={width:k.parentNode.offsetWidth,height:k.parentNode.offsetHeight,scrollWidth:k.parentNode.scrollWidth,fontSize:k.style.fontSize};if(r.clientDimensions.scrollWidth==r.clientDimensions.width*2){var p=k.lastChild.offsetTop+k.lastChild.offsetHeight;r.clientDimensions.scrollWidth=r.clientDimensions.width*(p>r.clientDimensions.height?2:1)}r.clientDimensions.pages=Math.ceil(r.clientDimensions.scrollWidth/r.clientDimensions.width);return r.clientDimensions}function B(p){for(var k=0;k<r.chapters.length;++k){var E=r.chapters[k];E.page=1;if(E.fragment){var F=document.getElementById(E.fragment);while(F&&F.parentNode!=p){F=F.parentNode}if(F){F.scrollIntoView();E.page=(p.parentNode.scrollLeft/r.clientDimensions.width)+1}}}p.parentNode.scrollLeft=0;return r.chapters}function t(J){if(!J.getBoundingClientRect){console.log("Occlusion not supported");return}else{console.log("Locating occlusions")}var F=[];var E=J.getBoundingClientRect();for(var H=0;H<J.childNodes.length;++H){var I=J.childNodes[H];var k=J.childNodes[H-1];if(!k){F.push(I)}else{var p=I.getBoundingClientRect();var G=k.getBoundingClientRect();if(G.bottom<=E.bottom&&p.top<=G.top){F.push(I)}}I.style.color="#000"}for(H=0;H<F.length;++H){F[H].style.color="#F0F"}}function l(E){r.chunks=[];var k=r.elementsForClient[z(E)];var p=r.clientDimensions.pages;var F=Math.ceil(k.length/(p/4));var I=Math.ceil(k.length/F);var J=0;for(var H=0;H<I;++H){for(var G=0;G<F&&E.hasChildNodes();++G,++J){E.removeChild(E.firstChild)}var K=Math.floor(E.parentNode.scrollWidth/r.clientDimensions.width);r.chunks.push({firstElementIndex:J-G,lastElementIndex:J,firstPageNumber:(r.clientDimensions.pages-p)+1,lastPageNumber:(r.clientDimensions.pages-K)+1});p=K}return r.chunks}function c(F,p){var k=p.length;for(var E=0;E<k;++E){F.appendChild(p[E])}return k}function x(F,p){var k;if(p){k=p.length;for(var E=0;E<k;++E){if(p[E].parentNode==F){F.removeChild(p[E])}}return k}k=F.childNodes.length;while(F.hasChildNodes()){F.removeChild(F.firstChild)}return k}function v(){return r.clientDimensions?r.clientDimensions.pages:null}u.applyTo=A;u.updateDimensions=i;u.lastPageNumber=v;u.prepareNode=b;u.chapterForPage=g;u.pageForChapter=d;a();return u};Monocle.Styles={ruleText:function(b){if(typeof b=="string"){b=this[b]}if(!b){return""}var a=[];for(var c in b){a.push(c+": "+b[c]+";")}return a.join(" ")},container:{position:"absolute",width:"100%",height:"100%","-webkit-user-select":"none","-webkit-text-size-adjust":"none"},overlay:{position:"absolute",display:"none",width:"100%",height:"100%","z-index":"1000"},page:{position:"absolute",top:"0",left:"0",bottom:"3px",right:"5px",background:"#FFF",cursor:"pointer","z-index":"1","-webkit-box-shadow":"2px 0 2px #999","-moz-box-shadow":"2px 0 2px #999","-webkit-transform-style":"preserve-3d"},scroller:{position:"absolute",top:"1em",bottom:"1em",left:"1em",right:"1em",overflow:"hidden"},content:{position:"absolute",top:"0",bottom:"0","min-width":"200%","-webkit-text-size-adjust":"none","-webkit-column-gap":"0","-webkit-column-fill":"auto","-moz-column-gap":"0","-moz-column-fill":"auto"},spinner:{width:"48px",height:"48px",position:"relative",display:"block",margin:"auto"},control:{"z-index":"100"}};Monocle.Styles.Controls={};Monocle.Styles.Flippers={};Monocle.Flippers={};Monocle.Controls={};Monocle.Flippers.Legacy=function(g,j){if(Monocle.Flippers==this){return new Monocle.Flippers.Legacy(g,j)}var c={LEGACY_MESSAGE:'Your browser doesn\'t support Monocle\'s full feature set. You could try <a href="http://mozilla.com/firefox">Firefox</a>, Apple\'s <a href="http://apple.com/safari">Safari</a> or Google\'s <a href="http://google.com/chrome">Chrome</a>.',buttonText:{PREV:"... Previous part",NEXT:"Next part..."}};var a={pageCount:1,divs:{}};var b={constructor:Monocle.Flippers.Legacy,properties:a,constants:c};function d(){a.reader=g;a.setPageFn=j}function i(k){a.page=k}function f(){return[a.page]}function o(){return a.reader.getBook().placeFor(a.page.contentDiv)}function n(p){var k=a.setPageFn(a.page,p,m);a.reader.dispatchEvent("monocle:turn");return k}function h(){a.page.scrollerDiv.style.right="0";a.page.scrollerDiv.style.overflow="auto";a.page.contentDiv.style.position="relative";a.page.contentDiv.style.width="100%";a.page.contentDiv.style.minWidth="0%";if(!a.divs.legacyMessage){a.divs.legacyMessage=document.createElement("div");a.divs.legacyMessage.innerHTML=c.LEGACY_MESSAGE;a.divs.legacyMessage.style.cssText=Monocle.Styles.ruleText(Monocle.Styles.Flippers.Legacy.message);a.page.scrollerDiv.insertBefore(a.divs.legacyMessage,a.page.contentDiv)}if(!a.divs.prevButton){a.divs.prevButton=document.createElement("div");a.divs.prevButton.innerHTML=c.buttonText.PREV;a.divs.prevButton.style.cssText=Monocle.Styles.ruleText(Monocle.Styles.Flippers.Legacy.button);a.page.scrollerDiv.insertBefore(a.divs.prevButton,a.page.contentDiv)}if(!a.divs.nextButton){a.divs.nextButton=document.createElement("div");a.divs.nextButton.innerHTML=c.buttonText.NEXT;a.divs.nextButton.style.cssText=Monocle.Styles.ruleText(Monocle.Styles.Flippers.Legacy.button);a.page.scrollerDiv.appendChild(a.divs.nextButton)}}function m(){var k=o().properties.component.properties.index;if(k==0){a.divs.legacyMessage.style.display="block";a.divs.prevButton.style.display="none"}else{a.divs.legacyMessage.style.display="none";a.divs.prevButton.style.display="block"}if(k==a.reader.getBook().properties.lastCIndex){a.divs.nextButton.style.display="none"}else{a.divs.nextButton.style.display="block"}}function l(){Monocle.addListener(a.divs.prevButton,"click",function(){n({percent:-0.5})});Monocle.addListener(a.divs.nextButton,"click",function(){n({percent:1.5})})}b.pageCount=a.pageCount;b.addPage=i;b.visiblePages=f;b.getPlace=o;b.moveTo=n;b.listenForInteraction=l;b.overrideDimensions=h;d();return b};Monocle.Styles.Flippers.Legacy={message:{border:"1px solid #987",background:"#FFC",color:"#333","font-family":"Helvetica, Arial, sans-serif","font-size":"11px","margin-right":"3px","margin-bottom":"3px",padding:"0.5em 1em"},button:{background:"#DDD",padding:"6px",border:"1px solid #666",color:"#009",font:"bold 12px Helvetica, Arial, sans-serif","text-shadow":"-1px -1px #EEE","border-radius":"5px","margin-right":"3px","margin-bottom":"3px","margin-top":"3px"}};Monocle.Flippers.Slider=function(a,H){if(Monocle.Flippers==this){return new Monocle.Flippers.Slider(a,H)}var x={FORWARDS:1,BACKWARDS:-1,durations:{SLIDE:240,FOLLOW_CURSOR:100,ANTI_FLICKER_DELAY:20}};var t={pageCount:2,activeIndex:1,divs:{pages:[]},turnData:{}};var u={constructor:Monocle.Flippers.Slider,properties:t,constants:x};function b(){t.reader=a;t.setPageFn=H}function f(k){t.divs.pages.push(k)}function l(){return[d()]}function E(){t.reader.addListener("monocle:contact:start",function(k){if(j(k.monocleData.contactX)){k.preventDefault()}});t.reader.addListener("monocle:contact:move",function(k){if(F(k.monocleData.contactX)){k.preventDefault()}});t.reader.addListener("monocle:contact:end",function(k){if(h(k.monocleData.contactX)){k.preventDefault()}})}function B(k){k=k||d();return t.reader.getBook().placeFor(k.contentDiv)}function o(k){m(d(),k);G()}function m(k,p,K){var J=function(L){k.scrollerDiv.scrollLeft=L;s(k.scrollerDiv,0,{duration:0},K)};return t.setPageFn(k,p,J)}function q(k){return k>t.reader.properties.pageWidth*0.6}function D(k){return k<t.reader.properties.pageWidth*0.4}function d(){return t.divs.pages[t.activeIndex]}function i(){return t.divs.pages[(t.activeIndex+1)%2]}function g(){d().style.zIndex=1;i().style.zIndex=2;return t.activeIndex=(t.activeIndex+1)%2}function v(k){setTimeout(k,x.durations.ANTI_FLICKER_DELAY)}function z(k){t.turnData.animating=false;if(t.turnData.dropped){h(k);t.turnData.dropped-=1}}function w(){var k=B(d());var p=B(i());return(k.componentId()==p.componentId()&&k.pageNumber()==p.pageNumber())}function j(p){if(t.turnData.animating||t.turnData.direction){return false}t.turnData.points={start:p,min:p,max:p};if(q(p)){if(!w()){t.turnData.direction=x.FORWARDS;c(p);z()}return true}else{if(D(p)){t.turnData.animating=true;var k=B();var J=m(i(),k.getLocus({direction:x.BACKWARDS}),function(){t.turnData.direction=x.BACKWARDS;v(function(){n(function(){v(function(){g();c(p);z(p)})})})});if(!J){t.turnData={};return false}return true}}return false}function F(J){if(t.turnData.animating||!t.turnData.direction){return false}t.turnData.points.min=Math.min(t.turnData.points.min,J);t.turnData.points.max=Math.max(t.turnData.points.max,J);var k=(new Date()).getTime();var p=x.durations.FOLLOW_CURSOR;if(t.turnData.stamp&&k-t.turnData.stamp<p){return false}t.turnData.stamp=k;c(J);return true}function h(k){if(t.turnData.animating){t.turnData.dropped=true;return true}if(!t.turnData.direction){return false}t.turnData.animating=true;t.turnData.points.tap=t.turnData.points.max-t.turnData.points.min<10;if(t.turnData.direction==x.FORWARDS){if(t.turnData.points.tap||t.turnData.points.start-k>60||t.turnData.points.min>=k){r(g)}else{A()}return true}else{if(t.turnData.direction==x.BACKWARDS){if(t.turnData.points.tap||k-t.turnData.points.start>60||t.turnData.points.max<=k){A()}else{r(g)}return true}}return false}function G(){var k=B();var p=function(){t.reader.dispatchEvent("monocle:turn");t.turnData={}};if(!m(i(),k.getLocus({direction:x.FORWARDS}),function(){C(p)})){m(i(),k.getLocus(),function(){C(p)})}}function s(M,P,S,Q){var O;var N;if(typeof(P)=="number"){P=P+"px"}if(!S.duration){N=0;O="none"}else{N=parseInt(S.duration);O="-webkit-transform";O+=" "+N+"ms";O+=" "+(S.timing||"linear");O+=" "+(S.delay||0)+"ms"}if(typeof WebKitTransitionEvent!="undefined"){M.style.webkitTransition=O;M.style.webkitTransform="translateX("+P+")"}else{if(O!="none"){clearTimeout(M.setXTransitionInterval);var p=(new Date()).getTime();var R=40;var K=parseInt(P);var J=y(M);var L=(K-J)*(R/N);var k=function(){var T=J+L;if((new Date()).getTime()-p>N||Math.abs(J-K)<=Math.abs((J+L)-K)){clearTimeout(M.setXTransitionInterval);M.style.MozTransform="translateX("+K+"px)";if(M.setXTCB){M.setXTCB()}}else{M.style.MozTransform="translateX("+T+"px)";J=T}};M.setXTransitionInterval=setInterval(k,R)}else{M.style.MozTransform="translateX("+P+")"}}if(M.setXTCB){Monocle.removeListener(M,"webkitTransitionEnd",M.setXTCB);M.setXTCB=null}if(Q){if(O=="none"||y(M)==parseInt(P)){Q()}else{M.setXTCB=Q;Monocle.addListener(M,"webkitTransitionEnd",M.setXTCB)}}}function y(p){if(typeof WebKitCSSMatrix=="object"){var k=window.getComputedStyle(p).webkitTransform;k=new WebKitCSSMatrix(k);return k.m41}else{var J=p.style.MozTransform;if(!J||J==""){return 0}return parseFloat((/translateX\((\-?.*)px\)/).exec(J)[1])||0}}function C(k){s(i(),0,{duration:1},k)}function n(k){s(i(),0-t.reader.properties.pageWidth,{duration:0},k)}function I(k,p){s(i(),Math.min(0,k-t.reader.properties.pageWidth),{duration:0},p)}function A(J){var p={duration:x.durations.SLIDE,timing:"ease-in"};var k=G;if(J&&J!=G){k=function(){J();G()}}s(d(),0,p,k)}function r(J){var p={duration:x.durations.SLIDE,timing:"ease-in"};var k=G;if(J&&J!=G){k=function(){J();G()}}s(d(),0-t.reader.properties.pageWidth,p,k)}function c(k,p){s(d(),Math.min(0,k-t.reader.properties.pageWidth),{duration:x.durations.FOLLOW_CURSOR},p)}u.pageCount=t.pageCount;u.addPage=f;u.visiblePages=l;u.getPlace=B;u.moveTo=o;u.listenForInteraction=E;b();return u};